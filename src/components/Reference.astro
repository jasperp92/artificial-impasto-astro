---
const {
  title,
  authors,
  year,
  link,
  type = "paper",   // paper, software, github, website, download, internal ...
  label = "",
  embed = false,
} = Astro.props;

function getDefaultLabel(type) {
  switch (type) {
    case "software":
      return "Software-Projekt";
    case "github":
      return "GitHub-Repository";
    case "website":
      return "Blog-Eintrag";
    case "download":
      return "Download";
    case "internal":
      return "Interner Link";
    case "paper":
      return "Paper";
    default:
      return "Link";
  }
}

const hasCustomLabel = !!label;
const displayLabel = hasCustomLabel
  ? label
  : getDefaultLabel(type);

// Icons je nach Typ
const iconPath =
  type === "download"
    ? "M13 17V3h-2v10H9v-2H7v2h2v2h2v2h2zm8 2v-4h-2v4H5v-4H3v6h18v-2zm-8-6v2h2v-2h2v-2h-2v2h-2z"
    : type === "internal"
    ? "M14 5h-2v4H6v2H4v6h2v-2h6v4h2v-2h2v-2h2v-2h2v-2h-2V9h-2V7h-2V5z"
    : type === "software"
    ? "M8 5h2v2H8V5zM6 7h2v2H6V7zM4 9h2v2H4V9zm-2 2h2v2H2v-2zm2 2h2v2H4v-2zm2 2h2v2H6v-2zm2 2h2v2H8v-2zm8-12h-2v2h2V5zm2 2h-2v2h2V7zm2 2h-2v2h2V9zm2 2h-2v2h2v-2zm-2 2h-2v2h2v-2zm-2 2h-2v2h2v-2zm-2 2h-2v2h2v-2z"
    : type === "github"
    ? "M5 2h4v2H7v2H5V2Zm0 10H3V6h2v6Zm2 2H5v-2h2v2Zm2 2v-2H7v2H3v-2H1v2h2v2h4v4h2v-4h2v-2H9Zm0 0v2H7v-2h2Zm6-12v2H9V4h6Zm4 2h-2V4h-2V2h4v4Zm0 6V6h2v6h-2Zm-2 2v-2h2v2h-2Zm-2 2v-2h2v2h-2Zm0 2h-2v-2h2v2Zm0 0h2v4h-2v-4Z"
    : type === "website"
    ? "M2 3h20v18H2V3zm18 16V7H4v12h16z"
    : "M5 2h16v20H3V2h2zm14 18V4H5v16h14zM7 6h10v2H7V6zm10 4H7v2h10v-2zM7 14h7v2H7v-2z";
---

{embed ? (
  <div class="my-6">
    <h3 class="mb-2">{title}</h3>
    <p class="text-sm text-gray-400 mb-2">
      {authors} ({year})
    </p>
    <iframe src={link} width="100%" height="600" class="border rounded" />
  </div>
) : (
  <a
    href={link}
    target={type === "internal" ? "_self" : "_blank"}
    rel={type === "internal" ? undefined : "noopener noreferrer"}
    class="block layout-box mb-6 h-fit"
  >
    <div class="italic inline-flex">
      <svg
        class="w-6 h-6 mb-2 text-black dark:text-white"
        fill="currentColor"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
      >
        <path d={iconPath} />
      </svg>
      <p class="ml-2">{displayLabel}</p>
    </div>
    <div class="text-xl font-bold">{title}</div>
    <slot />
    {type !== "internal" && (
      <p class="text-sm text-gray-400">
        {authors} ({year})
      </p>
    )}
  </a>
)}
