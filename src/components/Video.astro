---
const {
  src,
  type = "youtube",
  title = "Video",
  autoplay = false,
  loop = false,
  muted = true,     // empfehlenswert, sonst blockiert Autoplay in vielen Browsern
} = Astro.props;


// YouTube & Vimeo brauchen Iframes, MP4 ein <video>
let embedHtml = "";

if (type === "youtube") {
  const id = src.split("v=")[1]?.split("&")[0] || src.split("/").pop();
  embedHtml = `<iframe 
    src="https://www.youtube.com/embed/${id}${autoplay ? "?autoplay=1" : ""}" 
    title="${title}" 
    frameborder="0" 
    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
    allowfullscreen
    class="w-full h-full"
  ></iframe>`;
} else if (type === "vimeo") {
  const id = src.split("/").pop();
  embedHtml = `<iframe 
    src="https://player.vimeo.com/video/${id}${autoplay ? "?autoplay=1" : ""}${loop ? "&loop=1" : ""}" 
    title="${title}" 
    frameborder="0" 
    allow="autoplay; fullscreen; picture-in-picture" 
    allowfullscreen
    class="w-full h-full"
  ></iframe>`;
} else if (type === "mp4") {
  embedHtml = `<video
    ${autoplay ? "autoplay" : ""}
    ${loop ? "loop" : ""}
    ${muted ? "muted" : ""}
    playsinline
    controls
    class="w-full h-full custom-controls"
  >
    <source src="${src}" type="video/mp4">
    Dein Browser unterst√ºtzt das Video-Tag nicht.
  </video>`;
}
---

<div class="relative w-full aspect-video overflow-hidden mb-6">
  <Fragment set:html={embedHtml} />
</div>