---
const { frontmatter } = Astro.props;
const title = frontmatter?.title || "Artificial Impasto";
const background = frontmatter?.background || null;
// effect(s) tolerant einlesen (Array oder Komma-String)
const effectsRaw = frontmatter?.effects ?? frontmatter?.effect ?? [];
const effects = Array.isArray(effectsRaw)
  ? effectsRaw
  : String(effectsRaw || "")
      .split(",")
      .map((s) => s.trim())
      .filter(Boolean);

import Footer from "../components/Footer.astro";
import Navigation from "../components/Navigation.astro";
import ThemeToggle from "../components/ThemeToggle.astro";
import Background from "@components/Background.astro";
import ModeSwitch from "@components/ModeSwitch.astro";
import MobileMenu from "@components/MobileMenu.astro";
import "../styles/global.css";

console.log("Frontmatter:", frontmatter);
---

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <title>{Astro.props.title || "Artificial Impasto"}</title>
    <script is:inline>
      const theme = localStorage.getItem("theme") || "light";
      if (theme === "dark") {
        document.documentElement.classList.add("dark");
      }
    </script>
  </head>
  <body class="min-h-screen relative">
    <Background background={background} effects={effects} />

    <div class="flex min-h-screen relative z-10">
      <!-- Desktop Sidebar -->
      <aside
        class="hidden md:block fixed top-0 left-0 h-screen w-60 border-r-0 p-4"
      >
        <Navigation />
      </aside>

      <!-- Mobile Menu Komponente -->
      <MobileMenu>
        <ThemeToggle slot="icons" />
        <ModeSwitch slot="icons" />
      </MobileMenu>

      <!-- Main Content -->
      <main class="flex-1 mt-4 max-w-260 p-6 mr-0 md:ml-60 md:mr-12">
        <slot />
      </main>
    </div>
    <Footer />
  </body>
</html>
