---
const { frontmatter } = Astro.props;
const title = frontmatter?.title || "Artificial Impasto";
const background = frontmatter?.background || null;
const description = frontmatter?.description;
// effect(s) tolerant einlesen (Array oder Komma-String)
const effectsRaw = frontmatter?.effects ?? frontmatter?.effect ?? [];
const effects = Array.isArray(effectsRaw)
  ? effectsRaw
  : String(effectsRaw || "")
      .split(",")
      .map((s) => s.trim())
      .filter(Boolean);

import Footer from "../components/Footer.astro";
import Navigation from "../components/Navigation.astro";
import ThemeToggle from "../components/ThemeToggle.astro";
import Background from "@components/Background.astro";
import ModeSwitch from "@components/ModeSwitch.astro";
import MobileMenu from "@components/MobileMenu.astro";
import PageNav from "@components/PageNav.astro";
import Lightbox from "@components/Lightbox.astro";
import "../styles/global.css";
---

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <title>{Astro.props.title || "Artificial Impasto"}</title>
    <script is:inline>
      const theme = localStorage.getItem("theme") || "light";
      if (theme === "dark") {
        document.documentElement.classList.add("dark");
      }
    </script>
  </head>
  <body class="min-h-screen relative">
    <Background background={background} effects={effects} />

    <!-- Fixed Sidebar -->
    <aside
      class="hidden md:block fixed top-0 left-0 h-screen w-60 border-r-0 p-4 pr-0 z-20"
    >
      <Navigation />
    </aside>

    <!-- Content-Bereich, rückt sich um Menü-Breite frei -->
    <div class="min-h-screen relative z-10 md:ml-60 md:mr-12 flex flex-col">
      <!-- Mobile Menu Komponente -->
      <MobileMenu>
        <ThemeToggle slot="icons" />
        <ModeSwitch slot="icons" />
      </MobileMenu>

      <!-- Main Content -->
      <main class="flex flex-col flex-1 mt-8 max-w-5xl p-4 mx-auto w-full">
        <h1>{title}</h1>
        <div class="subtitle">{description}</div>

        <!-- Content-Bereich dehnt sich -->
        <div class="flex-1">
          <slot />
        </div>

        <!-- Navi sitzt am unteren Rand -->
        <PageNav />
      </main>
      <Lightbox />
    </div>

    <Footer />
  </body>
</html>
